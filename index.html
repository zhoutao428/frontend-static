<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AI Workbench Pro</title>
    <!-- å¼•å…¥ FontAwesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- å¼•å…¥ Google Fonts å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- å¼•å…¥æˆ‘ä»¬çš„æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="./styles.css">
    <!-- æ¨¡å‹é€‰æ‹©å™¨æ ·å¼ -->
    <style>
        .model-selector-wrapper {
            display: flex; align-items: center; gap: 8px; 
            background: rgba(99, 102, 241, 0.1); /* ç´«è‰²èƒŒæ™¯åŒºåˆ† */
            padding: 4px 12px; border-radius: 8px; border: 1px solid rgba(99, 102, 241, 0.3);
            margin-left: 10px;
        }
        .model-selector-wrapper i { color: #a5b4fc; }
        #global-model-select {
            background: transparent; color: #e0e7ff; border: none; font-size: 13px; font-weight: 600; cursor: pointer;
        }
        #global-model-select option { background: #1e1b4b; color: white; }
    </style>
</head>
<body>
    <!-- === é¡¶éƒ¨å¯¼èˆªæ  === -->
    <header class="top-bar">
    <!-- 1. å·¦ä¾§ï¼šå“ç‰Œä¸é¡¹ç›® -->
    <div class="left-section">
        <div class="brand">
            <i class="fas fa-network-wired"></i>
            <span class="brand-text">Workbench</span>
        </div>
        <div class="divider-v"></div>
        
        <!-- é¡¹ç›®æ§åˆ¶ -->
        <div class="project-controls">
            <div class="select-wrapper">
                <i class="fas fa-cube"></i>
                <select id="global-project-select">
                    <option value="">åŠ è½½ä¸­...</option>
                </select>
            </div>
            <button class="btn-icon-only" id="btn-new-project" title="æ–°å»ºäº‘ç«¯é¡¹ç›®">
                <i class="fas fa-plus"></i>
            </button>
            <button class="btn-icon-only" id="btn-open-local" title="æŒ‚è½½æœ¬åœ°ä»£ç ">
                <i class="fas fa-folder-open"></i>
            </button>
        </div>
    </div>

    <!-- 2. ä¸­é—´ï¼šæ¨¡å‹æ§åˆ¶ (Cä½) -->
    <div class="center-section">
        <div class="model-selector-wrapper">
            <i class="fas fa-microchip"></i>
            <select id="global-model-select">
                <option disabled>åŠ è½½æ¨¡å‹...</option>
            </select>
        </div>
    </div>

        <!-- å³ä¾§å…¨å±€æ§åˆ¶ (New Layout) -->
    <div class="right-section top-controls">
        
        <!-- 1. è§†å›¾åˆ‡æ¢ -->
        <button class="btn-icon-text" id="view-mode-btn" title="åˆ‡æ¢è§†å›¾">
            <i class="fas fa-th-large"></i> ä¹å®«æ ¼
        </button>

        <div class="divider-v"></div>

        <!-- 2. åŠŸèƒ½ä¸­å¿ƒ (ä½¿ç”¨æ–°çš„ dropdown-trigger ç»“æ„) -->
        <div class="dropdown-trigger">
            <button class="btn-icon-text" id="features-btn">
                <i class="fas fa-cube"></i> åŠŸèƒ½ä¸­å¿ƒ
            </button>
            
            <!-- ä¸‹æ‹‰èœå• (ä½¿ç”¨æ–°çš„ user-menu æ ·å¼é£æ ¼ï¼Œæˆ–è€…ä¿æŒåŸæ ·) -->
            <div id="features-menu" class="dropdown-menu" style="min-width: 200px;">
                <div class="menu-header">
                    <div style="font-weight:bold; color:white;">åŠŸèƒ½ä¸­å¿ƒ</div>
                </div>
                <div class="menu-divider"></div>
                
                <a href="workflow-test/workflow-factory-test.html" class="menu-item">
                    <i class="fas fa-user-tie"></i> è§’è‰²ç®¡ç†
                </a>
                <a href="workflows/workflow-center.html" class="menu-item">
                    <i class="fas fa-sitemap"></i> ğŸš€ å·¥ä½œæµä¸­å¿ƒ
                </a>
                <a href="context-panel.html" class="menu-item">
                    <i class="fas fa-brain"></i> ä¸Šä¸‹æ–‡è®°å¿†
                </a>
            </div>
        </div>

        <div class="divider-v"></div>

        <!-- 3. ç”¨æˆ·ä¸ªäººä¸­å¿ƒ (æŠŠåŸæ¥çš„ç™»å½•æŒ‰é’®æ¢æˆè¿™ä¸ª) -->
        <div id="user-profile-area" class="user-profile-wrapper">
            <!-- æœªç™»å½• -->
            <button id="login-btn" class="btn-primary-glow" onclick="window.location.href='login.html'">
                ç™»å½• / æ³¨å†Œ
            </button>

            <!-- å·²ç™»å½• -->
            <div id="user-logged-in" class="user-pill" style="display:none;">
                <div class="balance-tag" onclick="window.open((process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001') + '/billing', '_blank')"
                    <i class="fas fa-coins"></i> <span id="user-balance">--</span>
                </div>
                <div class="avatar-trigger" id="avatar-btn">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User">
                </div>
                
                <!-- ç”¨æˆ·èœå• -->
                <div class="dropdown-menu user-menu" id="user-menu">
                    <div class="menu-header">
                        <div class="user-name" id="user-name-display">Guest</div>
                        <div class="user-email" id="user-email-display">...</div>
                    </div>
                    <div class="menu-divider"></div>
                    <a href="http://localhost:3001/billing" target="_blank" class="menu-item">
                        <i class="fas fa-credit-card"></i> æˆ‘çš„è´¦å•
                    </a>
                    <a href="config.html" class="menu-item">
                        <i class="fas fa-key"></i> è‡ªå®šä¹‰ Key
                    </a>
                    <div class="menu-divider"></div>
                    <a href="#" id="logout-btn" class="menu-item danger">
                        <i class="fas fa-sign-out-alt"></i> é€€å‡ºç™»å½•
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>
    <!-- === ä¸»å·¥ä½œåŒº (Flexå¸ƒå±€) === -->
    <div class="workspace">
        
        <!-- å·¦ä¾§ï¼šæ™ºèƒ½ä½“åˆ—è¡¨ (ä¾§è¾¹æ ) -->
        <aside class="sidebar" id="sidebar-area">
            <!-- ä¾§è¾¹æ å†…å®¹å·²æ¸…ç©ºï¼Œå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </aside>

        <!-- å³ä¾§ï¼šä¸»èˆå° (æ‰¿è½½çª—å£) -->
        <main class="stage" id="main-stage">
            <!-- è¿™é‡Œçš„å†…å®¹å°†ç”± JS åŠ¨æ€ä» hidden-pool ä¸­æ¬è¿è¿‡æ¥ -->
            <!-- é»˜è®¤åªæ˜¾ç¤ºä¸€ä¸ªçª—å£ -->
            <div class="empty-state" style="display:none;">
                <i class="fas fa-layer-group"></i>
                <p>ä»å·¦ä¾§æ‹–æ‹½æ™ºèƒ½ä½“åˆ°æ­¤å¤„å¼€å§‹åä½œ</p>
            </div>
        </main>
    </div>

    <!-- === åº•éƒ¨æ§åˆ¶å° === -->
    <div class="console-panel">
        <div class="console-header" id="console-header">
            <span><i class="fas fa-terminal"></i> TERMINAL / SYSTEM LOG</span>
            <div class="right-tools">
                <i class="fas fa-eraser" id="btn-clear-console" title="æ¸…ç©º"></i>
                <i class="fas fa-chevron-down" id="console-toggle-icon"></i>
            </div>
        </div>
        <div class="console-body">
            <div class="console-output" id="console-output">
                <div class="log-item info">ğŸš€ ç³»ç»Ÿæ ¸å¿ƒå·²åŠ è½½ [v2.0 Cyberpunk Edition]</div>
            </div>
            <div class="console-input-wrapper">
                <span class="prompt-char">âœ</span>
                <input type="text" id="console-cmd" placeholder="è¾“å…¥æŒ‡ä»¤ (e.g. @all report status)...">
            </div>
        </div>
    </div>

    <!-- === éšè—çš„çª—å£æ±  (ç©ºçš„å®¹å™¨ï¼ŒJSå°†åŠ¨æ€æ’å…¥çª—å£) === -->
    <div id="windows-pool" style="display:none;">
        <!-- çª—å£æ± å·²æ¸…ç©ºï¼Œå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆçª—å£å†…å®¹ -->
    </div>

    <!-- === é€šç”¨è¾“å…¥æ¨¡æ€æ¡† (æœ€ç»ˆç‰ˆ) === -->
    <div id="custom-modal" class="modal-backdrop" style="display:none;">
        <div class="modal-panel">
            <div class="modal-header">
                <h3 id="modal-title">è¯·è¾“å…¥</h3>
                <!-- å…³é—­æŒ‰é’® -->
                <button class="btn-icon-only" id="btn-close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" style="padding: 20px 0;">
                <input type="text" id="modal-input" class="modal-input" autocomplete="off">
            </div>

            <div class="modal-footer" style="display:flex; justify-content:flex-end; gap:10px;">
                <button class="btn btn-ghost" id="btn-cancel-modal">å–æ¶ˆ</button>
                <button class="btn btn-primary-glow" id="modal-confirm">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- å¼•ç”¨é€»è¾‘è„šæœ¬ -->
    <script type="module" src="./js/main.js"></script>
    <script>
        // åŠŸèƒ½ä¸­å¿ƒæ–°å¢åŠŸèƒ½çš„ä¸´æ—¶å®ç°
        function startContentWorkflow() {
            console.log('ğŸš€ å¯åŠ¨ä¸€é”®å†…å®¹åˆ›ä½œå·¥ä½œæµ');
            // å…³é—­åŠŸèƒ½èœå•
            document.getElementById('features-menu').style.display = 'none';
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„é€»è¾‘ï¼Œæ¯”å¦‚ï¼š
            // 1. åˆ›å»ºä¸“é—¨çš„å†…å®¹åˆ›ä½œæ™ºèƒ½ä½“
            // 2. æ‰“å¼€ä¸“ç”¨å·¥ä½œåŒº
            // 3. åŠ è½½é¢„è®¾æ¨¡æ¿ç­‰
            
            alert('ğŸ¬ ä¸€é”®å†…å®¹åˆ›ä½œå·¥ä½œæµå·²å¯åŠ¨ï¼\n\næ­¤åŠŸèƒ½å°†å¼•å¯¼æ‚¨å®Œæˆï¼š\n1. å†…å®¹ä¸»é¢˜é€‰æ‹©\n2. é£æ ¼è®¾å®š\n3. å¤šæ™ºèƒ½ä½“ååŒåˆ›ä½œ\n4. å†…å®¹ä¼˜åŒ–ä¸å‘å¸ƒ');
        }

        function startDataAnalysisWorkflow() {
            console.log('ğŸ“Š å¯åŠ¨æ•°æ®åˆ†æå·¥ä½œæµ');
            // å…³é—­åŠŸèƒ½èœå•
            document.getElementById('features-menu').style.display = 'none';
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„é€»è¾‘
            alert('ğŸ“ˆ æ•°æ®åˆ†æå·¥ä½œæµå·²å¯åŠ¨ï¼\n\næ­¤åŠŸèƒ½å°†å¼•å¯¼æ‚¨å®Œæˆï¼š\n1. æ•°æ®æºè¿æ¥\n2. æ•°æ®æ¸…æ´—\n3. åˆ†ææ¨¡å‹é€‰æ‹©\n4. å¯è§†åŒ–å‘ˆç°');
        }
        window.API_BASE_URL = '/api';
    </script>
</body>
</html>
